# Claude開発メモ

このファイルは、Claudeが効率的に開発を進めるための重要な情報を記録しています。

## プロジェクト構造

### プログラミングレッスンシステム

- **レッスン一覧ページ**: `src/pages/programming-lessons/index.astro`
- **個別レッスンページ**: `src/pages/programming-lessons/[lesson_id].astro`
- **Python実行環境**: Pyodideを使用したブラウザ内Python実行

#### プログラミングレッスンの特徴

1. **ステップバイステップ学習**
   - 各レッスンは複数のステップに分かれており、段階的に学習できる
   - 各ステップにはコード例、説明、解説が含まれる

2. **実行可能なコードエディタ**
   - CodeMirrorを使用したシンタックスハイライト付きエディタ
   - Pyodideによるブラウザ内でのPython実行
   - リアルタイムでの実行結果表示

3. **コピー&ペースト機能**
   - 各ステップのコード例をワンクリックでエディタにコピー可能
   - 学習者が手軽にコードを試せる

#### 新しいレッスンを追加する手順

1. **レッスン一覧に追加**
   `src/pages/programming-lessons/index.astro`の`lessons`配列に新しいレッスンを追加：
   ```javascript
   {
       id: 'lesson-id',           // URLに使用されるID
       title: 'レッスンタイトル',
       description: 'レッスンの説明',
       icon: '📝',                // 絵文字アイコン
       difficulty: 'easy|medium|hard',
       estimatedTime: 10,         // 推定学習時間（分）
       color: 'from-blue-500 to-indigo-600'  // Tailwindのグラデーション
   }
   ```

2. **レッスンページの作成**
   `src/pages/programming-lessons/[lesson-id].astro`を作成：
   ```javascript
   const steps = [
       {
           id: 1,
           title: 'ステップタイトル',
           description: 'ステップの説明',
           code: 'print("Hello")',  // コード例（\nで改行）
           explanation: '詳しい解説'
       },
       // 追加のステップ...
   ];
   ```

3. **既存のレッスンをテンプレートとして使用**
   - `src/pages/programming-lessons/print.astro`をコピーして編集
   - `steps`配列の内容を変更するだけで新しいレッスンが作成できる

#### レッスンページの構造

- **左側**: ステップカード（スクロール可能）
  - 各ステップの説明
  - コード例
  - 解説
  - コピーボタン

- **右側**: Pythonエディタ（固定表示）
  - CodeMirrorエディタ
  - 実行ボタン・クリアボタン
  - 実行結果表示エリア

#### レッスン作成のベストプラクティス

1. **適切なステップ数**: 5-10ステップが理想的
2. **段階的な難易度**: 簡単なものから徐々に複雑に
3. **実践的なコード例**: 実際に動くコードを提供
4. **丁寧な解説**: 初心者にもわかりやすい説明
5. **コメント付きコード**: 複雑なコードにはコメントを追加

#### プログラミングレッスン作成依頼のプロンプト例

**基本的な依頼の例：**

```
「じょうほうらいふ」のプログラミングレッスンに「変数」についてのレッスンを追加してください。

以下の内容を段階的に学習できるようにしてください：
- 変数とは何か
- 変数の作り方（代入）
- 変数の使い方
- 変数名のルール
- 複数の変数を使った計算

各ステップには、コード例と解説を含めてください。
```

**詳細な依頼の例：**

```
「じょうほうらいふ」のプログラミングレッスンに「if文（条件分岐）」のレッスンを追加してください。

【基本情報】
- レッスンID: if-statement
- レッスンタイトル: if文（条件分岐）
- 難易度: easy
- 推定学習時間: 15分
- アイコン: 🔀
- カラー: from-green-500 to-teal-600

【学習ステップ（7ステップ）】
1. if文とは何か（基本的な説明）
2. 単純なif文（条件が真の場合のみ実行）
3. if-else文（条件が偽の場合の処理）
4. 比較演算子の使い方（==, !=, >, <, >=, <=）
5. elif文（複数の条件分岐）
6. 論理演算子の使い方（and, or, not）
7. 実践例：年齢判定プログラム

【要望】
- 初心者にもわかりやすい説明を心がける
- 各ステップで実際に動くコードを提供
- コメントを適切に入れる
- 日本語の変数名や値を使って親しみやすくする
```

**複数レッスンの一括依頼の例：**

```
「じょうほうらいふ」のプログラミングレッスンに以下の3つのレッスンを追加してください：

1. **リスト（配列）の基礎**
   - リストの作成
   - 要素の追加・削除
   - インデックスを使った要素へのアクセス
   - リストの操作メソッド（append, remove, pop等）

2. **for文（繰り返し）**
   - for文の基本
   - rangeを使った繰り返し
   - リストの要素を順番に処理
   - ネストしたfor文

3. **関数の定義**
   - 関数とは何か
   - defを使った関数定義
   - 引数と戻り値
   - 関数の呼び出し方
   - 実践例：複数の関数を組み合わせる

各レッスンは5-8ステップで構成し、初心者向けの丁寧な解説とコード例を含めてください。
```

#### よくある依頼パターン

1. **特定のトピックのレッスン作成**
   - 「○○についてのレッスンを作成してください」
   - 学習内容を箇条書きで指定

2. **既存レッスンの改善**
   - 「print関数のレッスンにf文字列のステップを追加してください」
   - 特定のステップの修正や追加

3. **演習問題の追加**
   - 「変数のレッスンに練習問題を追加してください」
   - 学習後の確認問題の作成

### 問題演習システム

- **問題データの場所**: `public/questions/[unit_name]/questions.yaml`
- **問題一覧の管理**: `public/questions/index.yaml`
- **動的ルーティング**: `src/pages/quiz/[unit].astro`

### 新しい単元の問題を追加する手順

1. **問題ディレクトリの作成**
   ```bash
   mkdir public/questions/[unit_name]
   ```

2. **問題ファイルの作成**
   - `public/questions/[unit_name]/questions.yaml`を作成
   - 既存の問題ファイル（例：`public/questions/algorithms/questions.yaml`）と同じ構造を使用

3. **問題一覧への追加**
   - `public/questions/index.yaml`の`questionSets`配列に新しいunit_nameを追加

4. **動的ルーティングは自動更新**
   - `src/pages/quiz/[unit].astro`は`public/questions/index.yaml`から自動的に単元リストを読み取る
   - 手動でgetStaticPaths()を編集する必要はなし（2024年改善済み）

### 問題ファイルの構造

問題文、選択肢、説明などでMarkdown記法が使用可能です：
- **太字**: `**テキスト**` → **テキスト**
- *斜体*: `*テキスト*` → *テキスト*
- `コード`: `` `コード` `` → `コード`
- 改行: `<br>` または `\n`
- リンク: `[テキスト](URL)` → [テキスト](URL)

```yaml
id: unit_name
title: 単元名
description: 単元の説明
icon: 📝
difficulty: easy|medium|hard
estimatedTime: 数値（分）
category: カテゴリ名
tags:
  - タグ1
  - タグ2
questions:
  - id: q1
    type: single-choice|multiple-choice|true-false
    title: 問題のタイトル
    description: 問題文
    options:
      - id: a
        text: 選択肢のテキスト
        isCorrect: true|false
        explanation: 解説
    explanation: 問題全体の解説
    difficulty: easy|medium|hard
    tags:
      - 問題固有のタグ
    points: ポイント数
    hint: ヒント（オプション）
```

## 問題演習システムの動作

### クイズの流れ
1. **氏名入力画面**で名前を入力（修了証発行のため）
2. 問題を表示
3. ユーザーが選択肢を選択
4. 「次の問題」ボタンをクリック
5. **解説画面を表示**（正誤判定、選択肢ごとの解説、問題全体の解説）
6. 「次の問題へ」ボタンで次の問題、または「結果を見る」で終了
7. **100%達成時**: 修了証画面を表示し、ダウンロード可能

### 解説画面の内容
- 正解/不正解の判定と視覚的フィードバック
- 選択肢ごとの正誤表示（正解は緑、ユーザーの誤答は赤）
- 各選択肢の解説（option.explanation）
- 問題全体の詳しい解説（question.explanation）

## 開発時の注意点

- 新しい単元を追加する際は、上記の3つのステップを実行すること（動的ルーティングは自動更新）
- 問題ファイルの構造は既存のものと完全に一致させること（`correct_answer`形式ではなく`isCorrect`形式を使用）
- `public/questions/index.yaml`への追加を忘れると新しい単元にアクセスできない
- 選択肢と問題の両方に`explanation`フィールドを設定することで、より詳細な学習体験を提供

## 現在利用可能な問題セット

1. **binary_conversion** (2進数変換): 2進数と10進数の変換 - 初級レベル
2. **algorithms** (アルゴリズムの基礎): アルゴリズムと計算量 - 中級レベル  
3. **copyright** (著作権): 著作権法の基本概念と事例 - 中級レベル
4. **industrial** (産業財産権): 特許権、実用新案権、意匠権、商標権 - 中級レベル

## ネットワーク構築課題の重要な注意事項 ⚠️

**2025年9月16日の重要な学習事項：**

ネットワーク構築課題でシステム不具合が発生し、正しい解答が不正解と判定される問題が発覚しました。今後の課題作成時は以下に注意してください：

### 必ず確認すべき事項

1. **ネットワークシミュレータのデータ同期**
   - デバイスのIPアドレス変更時に `config.ipAddress` と `config.lan1.ipAddress` が同期されているか
   - JSONファイル保存→読み込み→再保存のフローで整合性が保たれるか

2. **問題演習システムの判定ロジック**
   - YAMLの `expectedChanges` が正しく解析されているか（特に配列形式の場合）
   - 重複IP判定で同じIPが複数回カウントされていないか
   - デバッグログを仕込んで判定過程を可視化する

3. **課題設計のベストプラクティス**
   - YAMLは配列形式より単純なオブジェクト形式を推奨
   - 課題ファイル→修正→判定の全フローを必ずテスト
   - ブラウザコンソールでのデバッグ情報確認を習慣化

### 詳細ガイド
トラブルシューティングの詳細は `/docs/network-exercise-development-guide.md` を参照してください。

---

## コマンド

- 開発サーバー起動: `npm run dev`
- ビルド: `npm run build`
- プレビュー: `npm run preview`